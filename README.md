# KeepInventoryImmediateRespawn

一个简单的 Spigot 插件，用于解决在使用跨服背包同步插件（HuskSync）时，因 `keepInventory` 规则不同而导致的物品丢失问题。

## 问题描述

这个问题主要出现在多服务器互联的环境中，特别是当不同服务器对 `keepInventory` 游戏规则有不同设置时。

我们假设有以下场景：
- **服务器 A**: 设置死亡不掉落。
- **服务器 B**: 设置死亡掉落。
- 两个服务器之间使用背包同步插件（如 HuskSync）互通玩家数据。

当一个玩家在 **服务器 A** 死亡时，由于 `keepInventory` 为 `true`，他的物品应该被保留。然而，如果此时 `doImmediateRespawn` 为 `false`，玩家会进入死亡屏幕，而不会立即重生。

如果玩家在这个“死亡但未重生”的状态下，切换到 **服务器 B**，会发生以下情况：
1.  背包同步插件将玩家的“死亡状态”同步到服务器 B。
2.  在服务器 B，死亡事件被触发，但这里的规则是死亡掉落，因此插件可能会同步一个空的物品栏。
3.  当玩家在服务器 B 重生时，他会发现自己所有的物品都丢失了。

这个问题最初在 [zth-issue-tracker#17](https://github.com/RIA-AED/zth-issue-tracker/issues/17) 中被提出。

## 插件行为

本插件通过一个简单的机制来规避这个问题。

它会监听玩家的死亡事件。如果玩家在一个 `keepInventory` 为 `true` 的世界中死亡，插件会强制玩家立即重生，即使 `doImmediateRespawn` 游戏规则为 `false`。

通过消除“死亡但未重生”这个中间状态，插件确保了玩家的背包数据在跨服同步前处于一个确定的、安全的状态，从而防止了物品的意外丢失。

## 使用方法

将插件放入 `plugins` 文件夹并重启服务器即可。无需任何配置。